<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?if $(var.Arch) = 386 ?>
  <?define ProgFolder=ProgramFilesFolder ?>
  <?else?>
  <?define ProgFolder=ProgramFiles64Folder ?>
  <?endif?>

  <Product
      Id="*"
      Name="Kolide {{.Opts.Name}} {{.Opts.Identifier}} $(var.Arch) {{.Opts.Version}}"
      Language="1033"
      Version="{{.Opts.Version}}"
      Manufacturer="https://kolide.com"
      UpgradeCode="{{.UpgradeCode}}" >

    <Package
	Id='*'
	Keywords='Installer'
	Description="Kolide {{.Opts.Name}} {{.Opts.Identifier}}"
	Comments="Kolide {{.Opts.Name}} {{.Opts.Identifier}}"
	InstallerVersion="300"
	Compressed="yes"
	InstallScope="perMachine"
	Languages="1033" />

    <!-- This holds the files generated by heat -->
    <Media Id='1' Cabinet="go.cab" EmbedCab="yes" CompressionLevel="high" />

    <MajorUpgrade AllowDowngrades="yes" />

    <!-- Set INSTALLDIR to "c:\Program Files\Kolide". With appropriate
	 WiX replacements along the way
	 Set DATADIR to "c:\ProgramData\Kolide"

	 It's up to the caller to decide which directories to use
    -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="$(var.ProgFolder)">
	<Directory Id="PROGDIR" Name="Kolide"/>
      </Directory>
      <Directory Id="CommonAppDataFolder">
	<Directory Id="DATADIR" Name="Kolide"/>
      </Directory>
    </Directory>

    <!-- Install the files -->
    <Feature
	Id="LauncherFiles"
	Title="Launcher"
	Level="1">
      <ComponentGroupRef Id="AppFiles" />
    </Feature>

  </Product>
</Wix>
